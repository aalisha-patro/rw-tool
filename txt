import React, { useState } from "react";
import { Container, Paper, Grid } from "@material-ui/core";
import FolderIcon from "@material-ui/icons/Folder";
import Breadcrumbs from "./Breadcrumbs";

const MainContent = ({ initialFolders }) => {
  const [currentFolder, setCurrentFolder] = useState(null);
  const [folderStack, setFolderStack] = useState([]);

  const handleFolderClick = (folder) => {
    const updatedStack = [...folderStack, currentFolder];
    setCurrentFolder(folder);
    setFolderStack(updatedStack);
  };

  const handleBreadcrumbClick = (index) => {
    const updatedStack = folderStack.slice(0, index);
    setCurrentFolder(updatedStack.pop() || null);
    setFolderStack(updatedStack);
  };

  const renderFolders = (folders) => {
    return folders.map((folder, index) => (
      <Grid item xs={3} key={index} onClick={() => handleFolderClick(folder)}>
        <FolderIcon />
        <span>{folder.name}</span>
        {folder.folders.length > 0 && renderFolders(folder.folders)}
      </Grid>
    ));
  };

  return (
    <Container>
      <Paper elevation={3} style={{ padding: "20px", marginBottom: "20px" }}>
        <Breadcrumbs
          breadcrumbs={folderStack.map((folder) => folder.name)}
          onClick={handleBreadcrumbClick}
        />
      </Paper>
      <Grid container spacing={3}>
        {currentFolder
          ? renderFolders(currentFolder.folders)
          : renderFolders(initialFolders.folders)}
      </Grid>
    </Container>
  );
};

export default MainContent;
